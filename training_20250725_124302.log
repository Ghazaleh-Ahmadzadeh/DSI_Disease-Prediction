2025-07-25 12:43:02,037 - INFO - ‚úÖ Configuration validation passed
2025-07-25 12:43:02,038 - INFO - üöÄ Starting LightGBM model training pipeline
2025-07-25 12:43:02,038 - INFO - Configuration: {'data_path': 'data/preprocessed', 'model_path': 'models', 'n_trials': 20, 'log_level': 'INFO', 'random_state': 42}
2025-07-25 12:43:02,038 - INFO - Using data_path from config.yml: data/preprocessed
2025-07-25 12:43:02,038 - INFO - Loading data from: ./data/preprocessed
2025-07-25 12:43:02,038 - INFO - Loading data from the most recent folder: './data/preprocessed/preprocessed_data_20250725_123021'
2025-07-25 12:43:02,045 - INFO - Data loaded successfully. Training with 1688 samples.
2025-07-25 12:43:02,046 - INFO - Features: 21, Classes: 7
2025-07-25 12:43:02,046 - INFO - ‚úÖ Data loaded successfully - Shape: (1688, 21), Classes: 7
2025-07-25 12:43:02,048 - INFO - Class distribution:
NObeyesdad
0    218
1    229
2    281
3    237
4    259
5    232
6    232
Name: count, dtype: int64
2025-07-25 12:43:02,048 - INFO - üîç Filtering features based on config.yml
2025-07-25 12:43:02,048 - INFO - Available features in dataset: ['Height', 'Weight', 'family_history_with_overweight', 'FAVC', 'FCVC', 'NCP', 'CAEC', 'SMOKE', 'CH2O', 'SCC', 'FAF', 'TUE', 'CALC', 'Gender_Male', 'MTRANS_Bike', 'MTRANS_Motorbike', 'MTRANS_Public_Transportation', 'MTRANS_Walking', 'Age_Category_Young Adult', 'Age_Category_Adult', 'Age_Category_Senior']
2025-07-25 12:43:02,048 - INFO - Selected features from config: ['Weight', 'Height', 'FCVC', 'NCP', 'CH2O', 'FAF', 'TUE', 'CAEC', 'CALC', 'family_history_with_overweight', 'FAVC', 'SMOKE', 'SCC', 'Gender_Male', 'MTRANS_Bike', 'MTRANS_Motorbike', 'MTRANS_Public_Transportation', 'MTRANS_Walking', 'Age_Category_Adult', 'Age_Category_Senior', 'Age_Category_Young Adult']
2025-07-25 12:43:02,049 - INFO - ‚úÖ Features filtered - Original: 21 features, Selected: 21 features
2025-07-25 12:43:02,049 - INFO - Final dataset shape: (1688, 21)
2025-07-25 12:43:02,049 - INFO - üîß Parameters to optimize (9): n_estimators (int: 100-1000), max_depth (int: 3-15), learning_rate (float: 0.01-0.3), num_leaves (int: 10-300), min_child_samples (int: 5-100), subsample (float: 0.6-1.0), colsample_bytree (float: 0.6-1.0), reg_alpha (float: 0.0-10.0), reg_lambda (float: 0.0-10.0)
2025-07-25 12:43:02,049 - INFO - üîß Starting hyperparameter optimization with 20 trials
2025-07-25 12:43:02,076 - INFO - Trial 0: Testing parameters {'n_estimators': 600, 'max_depth': 3, 'learning_rate': 0.05, 'num_leaves': 280, 'min_child_samples': 90, 'subsample': 0.7, 'colsample_bytree': 1.0, 'reg_alpha': 3.1, 'reg_lambda': 2.0, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:43:11,236 - INFO - Trial 0: CV Accuracy = 0.9490 ¬± 0.0124
2025-07-25 12:43:11,242 - INFO - Trial 1: Testing parameters {'n_estimators': 950, 'max_depth': 6, 'learning_rate': 0.15000000000000002, 'num_leaves': 100, 'min_child_samples': 60, 'subsample': 0.7, 'colsample_bytree': 0.8, 'reg_alpha': 0.6000000000000001, 'reg_lambda': 7.0, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:43:30,332 - INFO - Trial 1: CV Accuracy = 0.9633 ¬± 0.0097
2025-07-25 12:43:30,340 - INFO - Trial 2: Testing parameters {'n_estimators': 250, 'max_depth': 15, 'learning_rate': 0.12, 'num_leaves': 110, 'min_child_samples': 35, 'subsample': 1.0, 'colsample_bytree': 1.0, 'reg_alpha': 0.9, 'reg_lambda': 3.9000000000000004, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:43:37,853 - INFO - Trial 2: CV Accuracy = 0.9656 ¬± 0.0093
2025-07-25 12:43:37,857 - INFO - Trial 3: Testing parameters {'n_estimators': 950, 'max_depth': 3, 'learning_rate': 0.19, 'num_leaves': 70, 'min_child_samples': 65, 'subsample': 0.6, 'colsample_bytree': 0.6, 'reg_alpha': 8.200000000000001, 'reg_lambda': 4.3, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:43:48,584 - INFO - Trial 3: CV Accuracy = 0.8898 ¬± 0.0108
2025-07-25 12:43:48,590 - INFO - Trial 4: Testing parameters {'n_estimators': 900, 'max_depth': 4, 'learning_rate': 0.12, 'num_leaves': 20, 'min_child_samples': 45, 'subsample': 0.9, 'colsample_bytree': 0.7, 'reg_alpha': 9.200000000000001, 'reg_lambda': 0.30000000000000004, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:43:57,957 - INFO - Trial 4: CV Accuracy = 0.8874 ¬± 0.0082
2025-07-25 12:43:57,961 - INFO - Trial 5: Testing parameters {'n_estimators': 350, 'max_depth': 9, 'learning_rate': 0.03, 'num_leaves': 200, 'min_child_samples': 35, 'subsample': 0.8, 'colsample_bytree': 0.6, 'reg_alpha': 9.1, 'reg_lambda': 2.4000000000000004, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:44:08,773 - INFO - Trial 5: CV Accuracy = 0.8821 ¬± 0.0105
2025-07-25 12:44:08,778 - INFO - Trial 6: Testing parameters {'n_estimators': 150, 'max_depth': 15, 'learning_rate': 0.21000000000000002, 'num_leaves': 140, 'min_child_samples': 100, 'subsample': 0.9, 'colsample_bytree': 0.9, 'reg_alpha': 8.4, 'reg_lambda': 5.0, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:44:11,180 - INFO - Trial 6: CV Accuracy = 0.8785 ¬± 0.0108
2025-07-25 12:44:11,182 - INFO - Trial 7: Testing parameters {'n_estimators': 350, 'max_depth': 3, 'learning_rate': 0.29000000000000004, 'num_leaves': 200, 'min_child_samples': 50, 'subsample': 1.0, 'colsample_bytree': 1.0, 'reg_alpha': 6.800000000000001, 'reg_lambda': 5.9, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:44:15,097 - INFO - Trial 7: CV Accuracy = 0.9046 ¬± 0.0136
2025-07-25 12:44:15,100 - INFO - Trial 8: Testing parameters {'n_estimators': 150, 'max_depth': 10, 'learning_rate': 0.29000000000000004, 'num_leaves': 150, 'min_child_samples': 100, 'subsample': 0.7, 'colsample_bytree': 0.6, 'reg_alpha': 1.1, 'reg_lambda': 8.9, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:44:19,548 - INFO - Trial 8: CV Accuracy = 0.9567 ¬± 0.0125
2025-07-25 12:44:19,550 - INFO - Trial 9: Testing parameters {'n_estimators': 700, 'max_depth': 10, 'learning_rate': 0.03, 'num_leaves': 280, 'min_child_samples': 80, 'subsample': 0.8, 'colsample_bytree': 0.8, 'reg_alpha': 5.9, 'reg_lambda': 0.6000000000000001, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:44:32,447 - INFO - Trial 9: CV Accuracy = 0.9123 ¬± 0.0139
2025-07-25 12:44:32,486 - INFO - Trial 10: Testing parameters {'n_estimators': 350, 'max_depth': 15, 'learning_rate': 0.09999999999999999, 'num_leaves': 10, 'min_child_samples': 5, 'subsample': 1.0, 'colsample_bytree': 0.9, 'reg_alpha': 3.3000000000000003, 'reg_lambda': 8.9, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:44:39,925 - INFO - Trial 10: CV Accuracy = 0.9425 ¬± 0.0108
2025-07-25 12:44:39,961 - INFO - Trial 11: Testing parameters {'n_estimators': 750, 'max_depth': 7, 'learning_rate': 0.15000000000000002, 'num_leaves': 90, 'min_child_samples': 25, 'subsample': 0.6, 'colsample_bytree': 0.8, 'reg_alpha': 0.5, 'reg_lambda': 6.7, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:44:56,426 - INFO - Trial 11: CV Accuracy = 0.9633 ¬± 0.0087
2025-07-25 12:44:56,459 - INFO - Trial 12: Testing parameters {'n_estimators': 450, 'max_depth': 13, 'learning_rate': 0.2, 'num_leaves': 90, 'min_child_samples': 70, 'subsample': 0.7, 'colsample_bytree': 0.9, 'reg_alpha': 1.8, 'reg_lambda': 7.300000000000001, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:45:04,246 - INFO - Trial 12: CV Accuracy = 0.9550 ¬± 0.0102
2025-07-25 12:45:04,276 - INFO - Trial 13: Testing parameters {'n_estimators': 800, 'max_depth': 6, 'learning_rate': 0.11, 'num_leaves': 120, 'min_child_samples': 25, 'subsample': 0.9, 'colsample_bytree': 0.7, 'reg_alpha': 0.0, 'reg_lambda': 4.2, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:45:56,510 - INFO - Trial 13: CV Accuracy = 0.9704 ¬± 0.0084
2025-07-25 12:45:56,581 - INFO - Trial 14: Testing parameters {'n_estimators': 800, 'max_depth': 12, 'learning_rate': 0.08, 'num_leaves': 200, 'min_child_samples': 15, 'subsample': 0.9, 'colsample_bytree': 0.7, 'reg_alpha': 2.8000000000000003, 'reg_lambda': 3.5, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:46:13,734 - INFO - Trial 14: CV Accuracy = 0.9485 ¬± 0.0061
2025-07-25 12:46:13,806 - INFO - Trial 15: Testing parameters {'n_estimators': 550, 'max_depth': 6, 'learning_rate': 0.08, 'num_leaves': 50, 'min_child_samples': 30, 'subsample': 1.0, 'colsample_bytree': 0.7, 'reg_alpha': 4.5, 'reg_lambda': 3.4000000000000004, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:46:25,970 - INFO - Trial 15: CV Accuracy = 0.9325 ¬± 0.0099
2025-07-25 12:46:26,008 - INFO - Trial 16: Testing parameters {'n_estimators': 100, 'max_depth': 8, 'learning_rate': 0.12, 'num_leaves': 130, 'min_child_samples': 40, 'subsample': 0.9, 'colsample_bytree': 1.0, 'reg_alpha': 0.1, 'reg_lambda': 2.2, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:46:32,118 - INFO - Trial 16: CV Accuracy = 0.9668 ¬± 0.0076
2025-07-25 12:46:32,162 - INFO - Trial 17: Testing parameters {'n_estimators': 600, 'max_depth': 8, 'learning_rate': 0.24000000000000002, 'num_leaves': 180, 'min_child_samples': 15, 'subsample': 0.9, 'colsample_bytree': 0.7, 'reg_alpha': 2.1, 'reg_lambda': 2.1, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:46:39,523 - INFO - Trial 17: CV Accuracy = 0.9538 ¬± 0.0081
2025-07-25 12:46:39,558 - INFO - Trial 18: Testing parameters {'n_estimators': 850, 'max_depth': 5, 'learning_rate': 0.16, 'num_leaves': 250, 'min_child_samples': 45, 'subsample': 0.8, 'colsample_bytree': 0.8, 'reg_alpha': 0.0, 'reg_lambda': 1.3, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:47:21,571 - INFO - Trial 18: CV Accuracy = 0.9727 ¬± 0.0087
2025-07-25 12:47:21,615 - INFO - Trial 19: Testing parameters {'n_estimators': 850, 'max_depth': 5, 'learning_rate': 0.17, 'num_leaves': 240, 'min_child_samples': 20, 'subsample': 0.8, 'colsample_bytree': 0.8, 'reg_alpha': 4.4, 'reg_lambda': 1.3, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:47:30,396 - INFO - Trial 19: CV Accuracy = 0.9342 ¬± 0.0081
2025-07-25 12:47:30,400 - INFO - üéØ Optimization completed!
2025-07-25 12:47:30,400 - INFO - Best parameters: {'n_estimators': 850, 'max_depth': 5, 'learning_rate': 0.16, 'num_leaves': 250, 'min_child_samples': 45, 'subsample': 0.8, 'colsample_bytree': 0.8, 'reg_alpha': 0.0, 'reg_lambda': 1.3}
2025-07-25 12:47:30,400 - INFO - Best CV accuracy: 0.9727
2025-07-25 12:47:30,400 - INFO - Output model name: lgbm_model_20250725_124730.pkl
2025-07-25 12:47:30,401 - INFO - Final parameters for training: {'n_estimators': 850, 'max_depth': 5, 'learning_rate': 0.16, 'num_leaves': 250, 'min_child_samples': 45, 'subsample': 0.8, 'colsample_bytree': 0.8, 'reg_alpha': 0.0, 'reg_lambda': 1.3, 'verbosity': -1, 'random_state': 42, 'objective': 'multiclass', 'num_class': 7}
2025-07-25 12:47:30,401 - INFO - üèãÔ∏è Training final model with best parameters...
2025-07-25 12:47:38,980 - INFO - ‚úÖ Model saved successfully to: models/lgbm_model_20250725_124730.pkl
2025-07-25 12:47:38,981 - INFO - üìä Model file size: 6725.29 KB
2025-07-25 12:47:39,319 - INFO - üìä Final model training accuracy: 1.0000
2025-07-25 12:47:39,320 - INFO - üìä Cross-validation accuracy: 0.9727
2025-07-25 12:47:39,320 - INFO - üìä Overfitting (Train - CV): 0.0273
2025-07-25 12:47:39,322 - INFO - üìã Model metadata saved to: models/lgbm_metadata_20250725_124730.pkl
2025-07-25 12:47:39,322 - INFO - ‚úÖ Training pipeline completed successfully!
